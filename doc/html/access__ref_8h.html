<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ESAPI-C: access_ref.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ESAPI-C&#160;<span id="projectnumber">1.0</span></div>
   <div id="projectbrief">The OWASP Enterprise Security API for C</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('access__ref_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<h1>access_ref.h File Reference</h1>  </div>
</div>
<div class="contents">

<p>Access Reference Map module header.  
<a href="#_details">More...</a></p>
<div class="textblock"><code>#include &lt;stdbool.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="crypto_8h_source.html">crypto.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="uthash_8h_source.html">uthash.h</a>&quot;</code><br/>
</div>
<p><a href="access__ref_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_map__t.html">Map_t</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A hashable key-value pair for an access reference map.  <a href="struct_map__t.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adb7391c3aeef0d4e0299e4ace1d15408"></a><!-- doxytag: member="access_ref.h::_ACCESS_REF_H" ref="adb7391c3aeef0d4e0299e4ace1d15408" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>_ACCESS_REF_H</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a32a183eeadf922d255d06a4e4f2aca66"></a><!-- doxytag: member="access_ref.h::KEY_LEN" ref="a32a183eeadf922d255d06a4e4f2aca66" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="access__ref_8h.html#a32a183eeadf922d255d06a4e4f2aca66">KEY_LEN</a>&#160;&#160;&#160;7</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The fixed length of an access reference map key, generated by get_unique_reference(). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="access__ref_8h.html#a86369bddee02e95701be9bcca71cc1cf">VAL_LEN</a>&#160;&#160;&#160;64</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The maximum length of an access reference map value.  <a href="#a86369bddee02e95701be9bcca71cc1cf"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad3b65c8c1fd4f3c0d0fe8167c4f1d20e"></a><!-- doxytag: member="access_ref.h::map_t" ref="ad3b65c8c1fd4f3c0d0fe8167c4f1d20e" args="" -->
typedef struct <a class="el" href="struct_map__t.html">Map_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>map_t</b></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="access__ref_8h.html#a1e54a15dcdb26539c8ecdc307894008e">esapi_put_reference</a> (const char *, const char *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds an entry to the map.  <a href="#a1e54a15dcdb26539c8ecdc307894008e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="access__ref_8h.html#ab073378238a896e3ffa11d929939e5bc">esapi_get_indirect_reference</a> (const char *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the indirect object reference for the given direct object reference.  <a href="#ab073378238a896e3ffa11d929939e5bc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="access__ref_8h.html#a1f529c8289b4408f74f4a550d5b09e2b">esapi_get_direct_reference</a> (const char *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the direct object reference (original value) for the given indirect object reference.  <a href="#a1f529c8289b4408f74f4a550d5b09e2b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="access__ref_8h.html#ac0782ecd23166146eecc5e70f46c48f1">esapi_remove_direct_reference</a> (const char *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes the direct object reference from the map.  <a href="#ac0782ecd23166146eecc5e70f46c48f1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="access__ref_8h.html#a402b6330b4e3c5c92a74bb071fd19304">esapi_remove_indirect_reference</a> (const char *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes the indirect object reference from the map.  <a href="#a402b6330b4e3c5c92a74bb071fd19304"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="access__ref_8h.html#a040da60c053ba72839be5a7824bd8d4b">esapi_get_unique_reference</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a unique token string suitable for use as an indirect reference.  <a href="#a040da60c053ba72839be5a7824bd8d4b"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa9002aaaac025497dd7f9546a46d7dd9"></a><!-- doxytag: member="access_ref.h::v_map" ref="aa9002aaaac025497dd7f9546a46d7dd9" args="" -->
<a class="el" href="struct_map__t.html">map_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="access__ref_8h.html#aa9002aaaac025497dd7f9546a46d7dd9">v_map</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Value-to-key map. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2f95b767fe7a7a166cc726b59799c0de"></a><!-- doxytag: member="access_ref.h::k_map" ref="a2f95b767fe7a7a166cc726b59799c0de" args="" -->
<a class="el" href="struct_map__t.html">map_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="access__ref_8h.html#a2f95b767fe7a7a166cc726b59799c0de">k_map</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Key-to-value map. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Access Reference Map module header. </p>
<p>The Access Reference Map is used to map from a set of internal direct object references to a set of indirect references that are safe to disclose publicly. This can be used to help protect database keys, filenames, and other types of direct object references. As a rule, developers should not expose their direct object references as it enables attackers to attempt to manipulate them. </p>
<p>Indirect references are handled as strings, to facilitate their use in GUI controls or service messages. </p>
<p>Note that in addition to defeating all forms of parameter tampering attacks, there is a side benefit of the Access Reference Map. Using random strings as indirect object references, as opposed to simple integers makes it impossible for an attacker to guess valid identifiers. So if per-user Access Reference Maps are used, then request forgery attacks will also be prevented.</p>
<div class="fragment"><pre class="fragment">        <span class="keywordtype">char</span> *value = <span class="stringliteral">&quot;This is a direct object reference&quot;</span>;
        <a class="code" href="access__ref_8c.html#a71ca073c6f65845225035a100051bc0d" title="Adds an entry to the map.">esapi_put_reference</a>(<a class="code" href="access__ref_8c.html#a040da60c053ba72839be5a7824bd8d4b" title="Return a unique token string suitable for use as an indirect reference.">esapi_get_unique_reference</a>(value), value);
</pre></div><dl class="since"><dt><b>Since:</b></dt><dd>January 30, 2011 </dd></dl>

<p>Definition in file <a class="el" href="access__ref_8h_source.html">access_ref.h</a>.</p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="a86369bddee02e95701be9bcca71cc1cf"></a><!-- doxytag: member="access_ref.h::VAL_LEN" ref="a86369bddee02e95701be9bcca71cc1cf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VAL_LEN&#160;&#160;&#160;64</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The maximum length of an access reference map value. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000009">Todo:</a></b></dt><dd>Change to support dynamically sized values. </dd></dl>

<p>Definition at line <a class="el" href="access__ref_8h_source.html#l00047">47</a> of file <a class="el" href="access__ref_8h_source.html">access_ref.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a1f529c8289b4408f74f4a550d5b09e2b"></a><!-- doxytag: member="access_ref.h::esapi_get_direct_reference" ref="a1f529c8289b4408f74f4a550d5b09e2b" args="(const char *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* esapi_get_direct_reference </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the direct object reference (original value) for the given indirect object reference. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>character array containing an indirect object reference </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A character array containing a direct object reference </dd></dl>

<p>Definition at line <a class="el" href="access__ref_8c_source.html#l00064">64</a> of file <a class="el" href="access__ref_8c_source.html">access_ref.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab073378238a896e3ffa11d929939e5bc"></a><!-- doxytag: member="access_ref.h::esapi_get_indirect_reference" ref="ab073378238a896e3ffa11d929939e5bc" args="(const char *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* esapi_get_indirect_reference </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the indirect object reference for the given direct object reference. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>character array containing a direct object reference </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A character array containing an indirect object reference </dd></dl>

<p>Definition at line <a class="el" href="access__ref_8c_source.html#l00050">50</a> of file <a class="el" href="access__ref_8c_source.html">access_ref.c</a>.</p>

</div>
</div>
<a class="anchor" id="a040da60c053ba72839be5a7824bd8d4b"></a><!-- doxytag: member="access_ref.h::esapi_get_unique_reference" ref="a040da60c053ba72839be5a7824bd8d4b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* esapi_get_unique_reference </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return a unique token string suitable for use as an indirect reference. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>A character array containing an indirect object reference </dd></dl>

<p>Definition at line <a class="el" href="access__ref_8c_source.html#l00131">131</a> of file <a class="el" href="access__ref_8c_source.html">access_ref.c</a>.</p>

<p>References <a class="el" href="crypto_8c_source.html#l00296">esapi_fill_random_token()</a>, and <a class="el" href="access__ref_8h_source.html#l00040">KEY_LEN</a>.</p>

</div>
</div>
<a class="anchor" id="a1e54a15dcdb26539c8ecdc307894008e"></a><!-- doxytag: member="access_ref.h::esapi_put_reference" ref="a1e54a15dcdb26539c8ecdc307894008e" args="(const char *, const char *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool esapi_put_reference </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds an entry to the map. </p>
<p>The indirect reference should be obtained by calling <a class="el" href="access__ref_8c.html#a040da60c053ba72839be5a7824bd8d4b" title="Return a unique token string suitable for use as an indirect reference.">esapi_get_unique_reference()</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>character array containing an indirect object reference </td></tr>
    <tr><td class="paramname">A</td><td>character array containing a direct object reference </td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="access__ref_8c.html#a040da60c053ba72839be5a7824bd8d4b" title="Return a unique token string suitable for use as an indirect reference.">esapi_get_unique_reference()</a> </dd></dl>

<p>Definition at line <a class="el" href="access__ref_8c_source.html#l00110">110</a> of file <a class="el" href="access__ref_8c_source.html">access_ref.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac0782ecd23166146eecc5e70f46c48f1"></a><!-- doxytag: member="access_ref.h::esapi_remove_direct_reference" ref="ac0782ecd23166146eecc5e70f46c48f1" args="(const char *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool esapi_remove_direct_reference </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Removes the direct object reference from the map. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>character array containing a direct object reference </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="access__ref_8c_source.html#l00095">95</a> of file <a class="el" href="access__ref_8c_source.html">access_ref.c</a>.</p>

</div>
</div>
<a class="anchor" id="a402b6330b4e3c5c92a74bb071fd19304"></a><!-- doxytag: member="access_ref.h::esapi_remove_indirect_reference" ref="a402b6330b4e3c5c92a74bb071fd19304" args="(const char *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool esapi_remove_indirect_reference </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Removes the indirect object reference from the map. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>character array containing an indirect object reference </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="access__ref_8c_source.html#l00078">78</a> of file <a class="el" href="access__ref_8c_source.html">access_ref.c</a>.</p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="access__ref_8h.html">access_ref.h</a>      </li>
      <li class="footer">Generated on Mon Jan 31 2011 06:10:43 for ESAPI-C by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </li>
    </ul>
  </div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
