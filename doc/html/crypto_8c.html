<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ESAPI-C: crypto.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ESAPI-C&#160;<span id="projectnumber">1.0</span></div>
   <div id="projectbrief">The OWASP Enterprise Security API for C</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('crypto_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<h1>crypto.c File Reference</h1>  </div>
</div>
<div class="contents">

<p>A Cryptographic module implementation.  
<a href="#_details">More...</a></p>
<div class="textblock"><code>#include &lt;gcrypt.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdbool.h&gt;</code><br/>
<code>#include &quot;crypto.h&quot;</code><br/>
<code>#include &quot;base64.h&quot;</code><br/>
</div>
<p><a href="crypto_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6821bafc3c88dfb2e433a095df9940c6"></a><!-- doxytag: member="crypto.c::BUF_SIZE" ref="a6821bafc3c88dfb2e433a095df9940c6" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BUF_SIZE</b>&#160;&#160;&#160;1024</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a21797ace74c1aa06ef9a7f51266e4631">esapi_encrypt</a> (struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *ctx, const char *s)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts the provided plaintext characters using the cipher transformation specified by the property <code>Encryptor.CipherTransformation</code> and the <em>master encryption key</em> as specified by the property Encryptor.MasterKey as defined in the ESAPI.properties file.  <a href="#a21797ace74c1aa06ef9a7f51266e4631"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ada54967a9dd699dcd376359d0a9ba04c">esapi_decrypt</a> (struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *ctx, const char *s)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts the provided cyphertext string using the <em>master encryption key</em> as specified by the property Encryptor.MasterKey as defined in the ESAPI.properties file.  <a href="#ada54967a9dd699dcd376359d0a9ba04c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a13a560460f81c31d184f0613945587d5">esapi_crypto_init</a> (struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *ctx)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the cryptographic engine.  <a href="#a13a560460f81c31d184f0613945587d5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ae8a0c5208e532dffaf28956be1e47158">esapi_hash</a> (struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *ctx, const char *s)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a string representation of the hash of the provided plaintext and salt.  <a href="#ae8a0c5208e532dffaf28956be1e47158"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a15a9b2759f44a5b6d4b90d2b3b4902c7">esapi_fill_crypto_key</a> (struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *ctx, char *buff, int len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a random secret key using a cryptographic algorithm and entropy source appropriate for the generation of long term cryptographic keys.  <a href="#a15a9b2759f44a5b6d4b90d2b3b4902c7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ac5f468de6f8d67ebb7c6cb85f74f9654">esapi_fill_random_token</a> (struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *ctx, char *buff, int len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a random secret key using a cryptographic algorithm and entropy source appropriate for the generation of short term unique keys.  <a href="#ac5f468de6f8d67ebb7c6cb85f74f9654"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gcry_sexp_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a9e7e19d2d6ede98159531147cb91c0a9">esapi_sign</a> (struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *ctx, void *msg, int len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a signature of the given message.  <a href="#a9e7e19d2d6ede98159531147cb91c0a9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af9dc909ef560dd45eedcbafa11d34107"></a><!-- doxytag: member="crypto.c::convert_to_asymmetric_key" ref="af9dc909ef560dd45eedcbafa11d34107" args="(void *buff, int key_len)" -->
gcry_sexp_t&#160;</td><td class="memItemRight" valign="bottom"><b>convert_to_asymmetric_key</b> (void *buff, int key_len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a86f5a0d680c1174d90f8612c6ab93264">esapi_verify_signature</a> (struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *ctx, void *msg, int m_len, gcry_sexp_t *sig)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Incomplete function implementation.  <a href="#a86f5a0d680c1174d90f8612c6ab93264"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ad06f6e3f52cf7134df20ea3eabb8dc6d">encrypt_and_sign</a> (struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *ctx, void *msg, int len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Incomplete function implementation.  <a href="#ad06f6e3f52cf7134df20ea3eabb8dc6d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a53d8171b09003a778a85ab3b80af27c1">decrypt_and_verify</a> (struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *ctx, void *msg, int len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Incomplete function implementation.  <a href="#a53d8171b09003a778a85ab3b80af27c1"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0110d4273433c4659796c4e224e1d286"></a><!-- doxytag: member="crypto.c::esapi_alphabet" ref="a0110d4273433c4659796c4e224e1d286" args="[]" -->
char&#160;</td><td class="memItemRight" valign="bottom"><b>esapi_alphabet</b> [] = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>A Cryptographic module implementation. </p>
<p>This implementation wraps the GnuPG project's libgrypt library, which is available for many platforms. This library is designed to meet FIPS 140-2 requirements, and a version distributed for Redhat Linux is certified by NIST to be FIPS 1402 compliant at level 1.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>If you need to handle long term cryptographic keys that protect highly sensitive information, consider enabling Secure Memory in ESAPI properties to minimize the likelihood of key exposure on the host computer.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://www.gnupg.org/download/">http://www.gnupg.org/download/</a> </dd>
<dd>
<a href="http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/1401val2010.htm#1305">http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/1401val2010.htm#1305</a></dd></dl>
<dl class="since"><dt><b>Since:</b></dt><dd>January 30, 2011 </dd></dl>

<p>Definition in file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a53d8171b09003a778a85ab3b80af27c1"></a><!-- doxytag: member="crypto.c::decrypt_and_verify" ref="a53d8171b09003a778a85ab3b80af27c1" args="(struct esapi_ctx *ctx, void *msg, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* decrypt_and_verify </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Incomplete function implementation. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000008">Todo:</a></b></dt><dd>Implement. </dd></dl>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00378">378</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad06f6e3f52cf7134df20ea3eabb8dc6d"></a><!-- doxytag: member="crypto.c::encrypt_and_sign" ref="ad06f6e3f52cf7134df20ea3eabb8dc6d" args="(struct esapi_ctx *ctx, void *msg, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* encrypt_and_sign </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Incomplete function implementation. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000007">Todo:</a></b></dt><dd>Implement. </dd></dl>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00369">369</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a13a560460f81c31d184f0613945587d5"></a><!-- doxytag: member="crypto.c::esapi_crypto_init" ref="a13a560460f81c31d184f0613945587d5" args="(struct esapi_ctx *ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void esapi_crypto_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes the cryptographic engine. </p>
<p>This function must be called before calling any of the other functions in this module. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>A properly initialized ESAPI context structure returned by </p>
<div class="fragment"><pre class="fragment">                <a class="code" href="sec__context_8c.html#aa84c0a8f11407533c4ef22255de270e7" title="Load the ESAPI configuration.">load_security_context</a>() 
</pre></div> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00200">200</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="ada54967a9dd699dcd376359d0a9ba04c"></a><!-- doxytag: member="crypto.c::esapi_decrypt" ref="ada54967a9dd699dcd376359d0a9ba04c" args="(struct esapi_ctx *ctx, const char *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* esapi_decrypt </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Decrypts the provided cyphertext string using the <em>master encryption key</em> as specified by the property Encryptor.MasterKey as defined in the ESAPI.properties file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ciphertext</td><td>A Base64 encoded cyphertext character array to be decrypted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A character array containing the plaintext resulting from decrypting the specified ciphertext, or NULL on any failure to encrypt. </dd></dl>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00117">117</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p>Referenced by <a class="el" href="properties_8c_source.html#l00038">get_property()</a>.</p>

</div>
</div>
<a class="anchor" id="a21797ace74c1aa06ef9a7f51266e4631"></a><!-- doxytag: member="crypto.c::esapi_encrypt" ref="a21797ace74c1aa06ef9a7f51266e4631" args="(struct esapi_ctx *ctx, const char *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* esapi_encrypt </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Encrypts the provided plaintext characters using the cipher transformation specified by the property <code>Encryptor.CipherTransformation</code> and the <em>master encryption key</em> as specified by the property Encryptor.MasterKey as defined in the ESAPI.properties file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">plaintext</td><td>A character array containing the plaintext to be encrypted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A character array containing the resulting Base64 encoded cyphertext, or NULL on any failure to encrypt. </dd></dl>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00033">33</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p>Referenced by <a class="el" href="properties_8c_source.html#l00069">set_property()</a>.</p>

</div>
</div>
<a class="anchor" id="a15a9b2759f44a5b6d4b90d2b3b4902c7"></a><!-- doxytag: member="crypto.c::esapi_fill_crypto_key" ref="a15a9b2759f44a5b6d4b90d2b3b4902c7" args="(struct esapi_ctx *ctx, char *buff, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void esapi_fill_crypto_key </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generate a random secret key using a cryptographic algorithm and entropy source appropriate for the generation of long term cryptographic keys. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>A properly initialized ESAPI context structure returned by </p>
<div class="fragment"><pre class="fragment">                <a class="code" href="sec__context_8c.html#aa84c0a8f11407533c4ef22255de270e7" title="Load the ESAPI configuration.">load_security_context</a>() 
</pre></div> </td></tr>
    <tr><td class="paramname">buff</td><td>A character array to hold the resulting key </td></tr>
    <tr><td class="paramname">len</td><td>The requested length of the key </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00285">285</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac5f468de6f8d67ebb7c6cb85f74f9654"></a><!-- doxytag: member="crypto.c::esapi_fill_random_token" ref="ac5f468de6f8d67ebb7c6cb85f74f9654" args="(struct esapi_ctx *ctx, char *buff, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void esapi_fill_random_token </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generate a random secret key using a cryptographic algorithm and entropy source appropriate for the generation of short term unique keys. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>A properly initialized ESAPI context structure returned by </p>
<div class="fragment"><pre class="fragment">                <a class="code" href="sec__context_8c.html#aa84c0a8f11407533c4ef22255de270e7" title="Load the ESAPI configuration.">load_security_context</a>() 
</pre></div> </td></tr>
    <tr><td class="paramname">buff</td><td>A character array to hold the resulting key </td></tr>
    <tr><td class="paramname">len</td><td>The requested length of the key </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00296">296</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p>Referenced by <a class="el" href="access__ref_8c_source.html#l00131">esapi_get_unique_reference()</a>.</p>

</div>
</div>
<a class="anchor" id="ae8a0c5208e532dffaf28956be1e47158"></a><!-- doxytag: member="crypto.c::esapi_hash" ref="ae8a0c5208e532dffaf28956be1e47158" args="(struct esapi_ctx *ctx, const char *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* esapi_hash </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns a string representation of the hash of the provided plaintext and salt. </p>
<p>The salt helps to protect against a rainbow table attack by mixing in some extra data with the plaintext. Some good choices for a salt might be an account name or some other string that is known to the application but not to an attacker. See <a href="http://www.matasano.com/log/958/enough-with-the-rainbow-tables-what-you-need-to-know-about-secure-password-schemes/">this article</a> for more information about hashing as it pertains to password schemes.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>A valid <a class="el" href="structesapi__ctx.html" title="All of the persistable settings used by the ESAPI.">esapi_ctx</a> from which properly initialized cryptographic engine settings may be retrieved. </td></tr>
    <tr><td class="paramname">plaintext</td><td>the plaintext String to encrypt </td></tr>
    <tr><td class="paramname">salt</td><td>the salt to add to the plaintext String before hashing</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A character array containing the Base64 encoded encrypted hash of the given plaintext, or NULL on any failure. </dd></dl>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00255">255</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a9e7e19d2d6ede98159531147cb91c0a9"></a><!-- doxytag: member="crypto.c::esapi_sign" ref="a9e7e19d2d6ede98159531147cb91c0a9" args="(struct esapi_ctx *ctx, void *msg, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gcry_sexp_t* esapi_sign </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns a signature of the given message. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>A valid <a class="el" href="structesapi__ctx.html" title="All of the persistable settings used by the ESAPI.">esapi_ctx</a> from which properly initialized cryptographic engine settings may be retrieved. </td></tr>
    <tr><td class="paramname">msg</td><td>A character array containing the message </td></tr>
    <tr><td class="paramname">len</td><td>The length of the message </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A pointer to a gcry_sexp_t containing the signature </dd></dl>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00310">310</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a86f5a0d680c1174d90f8612c6ab93264"></a><!-- doxytag: member="crypto.c::esapi_verify_signature" ref="a86f5a0d680c1174d90f8612c6ab93264" args="(struct esapi_ctx *ctx, void *msg, int m_len, gcry_sexp_t *sig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int esapi_verify_signature </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gcry_sexp_t *&#160;</td>
          <td class="paramname"><em>sig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Incomplete function implementation. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>Fix to pass valid gcry_sexp_t parameters. </dd></dl>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00354">354</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="crypto_8c.html">crypto.c</a>      </li>
      <li class="footer">Generated on Mon Jan 31 2011 06:10:43 for ESAPI-C by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </li>
    </ul>
  </div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
