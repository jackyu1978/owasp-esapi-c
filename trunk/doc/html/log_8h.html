<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ESAPI-C: log.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ESAPI-C&#160;<span id="projectnumber">1.0</span></div>
   <div id="projectbrief">The OWASP Enterprise Security API for C</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('log_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<h1>log.h File Reference</h1>  </div>
</div>
<div class="contents">

<p>Logging module header.  
<a href="#_details">More...</a></p>
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &quot;log4c.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="user_8h_source.html">user.h</a>&quot;</code><br/>
</div>
<p><a href="log_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afc1987e4c0cbafbdb7d54201f2ea68d8"></a><!-- doxytag: member="log.h::DEFAULT_LOG_CATEGORY_NAME" ref="afc1987e4c0cbafbdb7d54201f2ea68d8" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DEFAULT_LOG_CATEGORY_NAME</b>&#160;&#160;&#160;&quot;root&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8e99e379f43426fb9e1ffcc2574b6b84"></a><!-- doxytag: member="log.h::SECURITY_LOG_PREFIX" ref="a8e99e379f43426fb9e1ffcc2574b6b84" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SECURITY_LOG_PREFIX</b>&#160;&#160;&#160;&quot;SECURITY:&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa3fbd1b7db5563bc97af47943afa34a4"></a><!-- doxytag: member="log.h::MAX_MESSAGE_LEN" ref="aa3fbd1b7db5563bc97af47943afa34a4" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_MESSAGE_LEN</b>&#160;&#160;&#160;256</td></tr>
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><b>EVENT_TYPE</b> { <b>SECURITY_SUCCESS</b>, 
<b>SECURITY_FAILURE</b>, 
<b>EVENT_SUCCESS</b>, 
<b>EVENT_FAILURE</b>
 }</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab975df1c95e9ffb147adb3c00709f00a"></a><!-- doxytag: member="log.h::esapi_open_log" ref="ab975df1c95e9ffb147adb3c00709f00a" args="()" -->
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log_8h.html#ab975df1c95e9ffb147adb3c00709f00a">esapi_open_log</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables logging for this process. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abdc3d2900ce4e7a28fa4e66239ed17ec"></a><!-- doxytag: member="log.h::esapi_close_log" ref="abdc3d2900ce4e7a28fa4e66239ed17ec" args="()" -->
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log_8h.html#abdc3d2900ce4e7a28fa4e66239ed17ec">esapi_close_log</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Disables logging for this process. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8fc8937a3e90a3c4cc4e66d28c5e01f2"></a><!-- doxytag: member="log.h::esapi_log_trace" ref="a8fc8937a3e90a3c4cc4e66d28c5e01f2" args="(const user *, int, const char *,...)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log_8h.html#a8fc8937a3e90a3c4cc4e66d28c5e01f2">esapi_log_trace</a> (const <a class="el" href="struct_user__t.html">user</a> *, int, const char *,...)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Log a TRACE level message. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a070444dad3a0bcdd42e46a83fd7949e7"></a><!-- doxytag: member="log.h::esapi_log_debug" ref="a070444dad3a0bcdd42e46a83fd7949e7" args="(const user *, int, const char *,...)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log_8h.html#a070444dad3a0bcdd42e46a83fd7949e7">esapi_log_debug</a> (const <a class="el" href="struct_user__t.html">user</a> *, int, const char *,...)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Log a DEBUG level message. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad3159e99a7a4a556152f47aa453475a0"></a><!-- doxytag: member="log.h::esapi_log_info" ref="ad3159e99a7a4a556152f47aa453475a0" args="(const user *, int, const char *,...)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log_8h.html#ad3159e99a7a4a556152f47aa453475a0">esapi_log_info</a> (const <a class="el" href="struct_user__t.html">user</a> *, int, const char *,...)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Log an INFO level message. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad02207e5ecb478ebdfc08d068a648b2d"></a><!-- doxytag: member="log.h::esapi_log_warn" ref="ad02207e5ecb478ebdfc08d068a648b2d" args="(const user *, int, const char *,...)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log_8h.html#ad02207e5ecb478ebdfc08d068a648b2d">esapi_log_warn</a> (const <a class="el" href="struct_user__t.html">user</a> *, int, const char *,...)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Log a WARN level message. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4ab42f3f2f13b137d345c9ff01d83bb4"></a><!-- doxytag: member="log.h::esapi_log_error" ref="a4ab42f3f2f13b137d345c9ff01d83bb4" args="(const user *, int, const char *,...)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log_8h.html#a4ab42f3f2f13b137d345c9ff01d83bb4">esapi_log_error</a> (const <a class="el" href="struct_user__t.html">user</a> *, int, const char *,...)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Log an ERROR level message. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6142aea17df875c3abad3db233b1462b"></a><!-- doxytag: member="log.h::esapi_log_critical" ref="a6142aea17df875c3abad3db233b1462b" args="(const user *, int, const char *,...)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log_8h.html#a6142aea17df875c3abad3db233b1462b">esapi_log_critical</a> (const <a class="el" href="struct_user__t.html">user</a> *, int, const char *,...)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Log a CRITICAL level message. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5ec45f1aebef752ed0e55691056956ad"></a><!-- doxytag: member="log.h::esapi_log_fatal" ref="a5ec45f1aebef752ed0e55691056956ad" args="(const user *, int, const char *,...)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="log_8h.html#a5ec45f1aebef752ed0e55691056956ad">esapi_log_fatal</a> (const <a class="el" href="struct_user__t.html">user</a> *, int, const char *,...)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Log a FATAL level message. <br/></td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae564bc2e377cef47f3f59effdf411c90"></a><!-- doxytag: member="log.h::eventTypeNames" ref="ae564bc2e377cef47f3f59effdf411c90" args="[]" -->
char *&#160;</td><td class="memItemRight" valign="bottom"><b>eventTypeNames</b> []</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Logging module header. </p>
<p>The Logging module defines a set of functions that can be used to log security events. It supports a hierarchy of logging levels which can be configured to determine the severity of events that are logged, and those below the threshold that are discarded. Implementors should use a well established logging library as it is quite difficult to create a high-performance logger.</p>
<p>The logging levels defined by this interface (in descending order) are: </p>
<ul>
<li>
fatal (highest value) </li>
<li>
error </li>
<li>
warning </li>
<li>
info </li>
<li>
debug </li>
<li>
trace (lowest value) </li>
</ul>
<p>ESAPI also allows for the definition of the type of log event that is being generated. The Logging module predefines 4 types of Log events: SECURITY_SUCCESS, SECURITY_FAILURE, EVENT_SUCCESS, EVENT_FAILURE. Your implementation can extend or change this list if desired.</p>
<p>This Logger allows callers to to submit events at different severity levels.<br/>
 <br/>
Implementors of this interface should:</p>
<ol>
<li>
provide a mechanism for setting the logging level threshold that is currently enabled. This usually works by logging all events at and above that severity level, and discarding all events below that level. This is usually done via configuration, but can also be made accessible programmatically. </li>
<li>
ensure that dangerous HTML characters are encoded before they are logged to defend against malicious injection into logs that might be viewed in an HTML based log viewer. </li>
<li>
encode any CRLF characters included in log data in order to prevent log injection attacks. </li>
<li>
avoid logging the user's session ID. Rather, they should log something equivalent like a generated logging session ID, or a hashed value of the session ID so they can track session specific events without risking the exposure of a live session's ID. </li>
<li>
record the following information with each event: <ol type="a">
<li>
identity of the user that caused the event, </li>
<li>
a description of the event (supplied by the caller), </li>
<li>
whether the event succeeded or failed (indicated by the caller), </li>
<li>
severity level of the event (indicated by the caller), </li>
<li>
that this is a security relevant event (indicated by the caller), </li>
<li>
hostname or IP where the event occurred (and ideally the user's source IP as well), </li>
<li>
a time stamp </li>
</ol>
</li>
</ol>
<p>Custom logger implementations might also: </p>
<ol start="6">
<li>
filter out any sensitive data specific to the current application or organization, such as credit cards, social security numbers, etc. </li>
</ol>
<p>A Log4c based logger is the default implementation. This implementations implements requirements #1 thru #5 above.<br/>
 <br/>
 Customization: It is expected that most organizations will implement their own custom Logging module in order to integrate ESAPI logging with their logging infrastructure. The ESAPI Reference Implementation is intended to provide a simple functional example of an implementation.</p>
<dl class="since"><dt><b>Since:</b></dt><dd>January 30, 2011 </dd></dl>

<p>Definition in file <a class="el" href="log_8h_source.html">log.h</a>.</p>
</div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="log_8h.html">log.h</a>      </li>
      <li class="footer">Generated on Mon Jan 31 2011 06:10:43 for ESAPI-C by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </li>
    </ul>
  </div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
