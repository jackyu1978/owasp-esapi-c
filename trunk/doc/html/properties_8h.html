<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ESAPI-C: properties.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ESAPI-C&#160;<span id="projectnumber">1.0</span></div>
   <div id="projectbrief">The OWASP Enterprise Security API for C</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('properties_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>properties.h File Reference</h1>  </div>
</div>
<div class="contents">

<p>Encrypted Properties module header.  
<a href="#_details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="uthash_8h_source.html">uthash.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="esapi_8h_source.html">esapi.h</a>&quot;</code><br/>
</div>
<p><a href="properties_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_map__t.html">Map_t</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A hashable key-value pair for an access reference map.  <a href="struct_map__t.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="properties_8h.html#a7187f600f02ca0e4459aa179b14497bd">MAX_PROPERTY_LINE_LENGTH</a>&#160;&#160;&#160;4096</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The EncryptedProperties module represents a properties file where all the data is encrypted before it is added, and decrypted when it retrieved.  <a href="#a7187f600f02ca0e4459aa179b14497bd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a32a183eeadf922d255d06a4e4f2aca66"></a><!-- doxytag: member="properties.h::KEY_LEN" ref="a32a183eeadf922d255d06a4e4f2aca66" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="properties_8h.html#a32a183eeadf922d255d06a4e4f2aca66">KEY_LEN</a>&#160;&#160;&#160;64</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The maximum allowed size for a property key. <br/></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad3b65c8c1fd4f3c0d0fe8167c4f1d20e"></a><!-- doxytag: member="properties.h::map_t" ref="ad3b65c8c1fd4f3c0d0fe8167c4f1d20e" args="" -->
typedef struct <a class="el" href="struct_map__t.html">Map_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="properties_8h.html#ad3b65c8c1fd4f3c0d0fe8167c4f1d20e">map_t</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A hashable key-value pair. <br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="properties_8h.html#a8e43c1c34fed476037718409e086781d">get_property</a> (<a class="el" href="struct_map__t.html">map_t</a> *, struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *, const char *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the plaintext property value for the given key from the given encrypted properties map.  <a href="#a8e43c1c34fed476037718409e086781d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="properties_8h.html#ad03b220df8766ed322c55c7ca4a3cb9b">get_property_or_default</a> (<a class="el" href="struct_map__t.html">map_t</a> *, struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *, const char *, const char *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the plaintext property value for the given key from the given encrypted properties map.  <a href="#ad03b220df8766ed322c55c7ca4a3cb9b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="properties_8h.html#a5dfcde20fcc2276506a7c99f6a323ba8">set_property</a> (<a class="el" href="struct_map__t.html">map_t</a> **, struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *, const char *, const char *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the given property key-value pair in the given encrypted properties map.  <a href="#a5dfcde20fcc2276506a7c99f6a323ba8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="properties_8h.html#a102c0a2264a8fe4c84d8b56ffd7a741e">keys</a> (<a class="el" href="struct_map__t.html">map_t</a> *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a list of all keys in the given encrypted properties map.  <a href="#a102c0a2264a8fe4c84d8b56ffd7a741e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_map__t.html">map_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="properties_8h.html#a46f3113de5787541e40a2e7302cfb4d6">load_properties</a> (const char *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read encrypted properties from the given file.  <a href="#a46f3113de5787541e40a2e7302cfb4d6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a753b51eee55d50d8e3692c4cb22ec210"></a><!-- doxytag: member="properties.h::store_properties" ref="a753b51eee55d50d8e3692c4cb22ec210" args="(map_t *, const char *)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="properties_8h.html#a753b51eee55d50d8e3692c4cb22ec210">store_properties</a> (<a class="el" href="struct_map__t.html">map_t</a> *, const char *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write encrypted properties to the given file. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Encrypted Properties module header. </p>

<p>Definition in file <a class="el" href="properties_8h_source.html">properties.h</a>.</p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="a7187f600f02ca0e4459aa179b14497bd"></a><!-- doxytag: member="properties.h::MAX_PROPERTY_LINE_LENGTH" ref="a7187f600f02ca0e4459aa179b14497bd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_PROPERTY_LINE_LENGTH&#160;&#160;&#160;4096</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The EncryptedProperties module represents a properties file where all the data is encrypted before it is added, and decrypted when it retrieved. </p>
<p>This interface can be implemented in a number of ways, the simplest being wrapping some hashing container library and overloading the behavior of the getProperty() and setProperty() functions. In all cases, the master encryption key is given by the Encryptor.MasterKey property in <b>ESAPI.properties</b> file.</p>
<dl class="since"><dt><b>Since:</b></dt><dd>January 30, 2011 </dd></dl>

<p>Definition at line <a class="el" href="properties_8h_source.html#l00023">23</a> of file <a class="el" href="properties_8h_source.html">properties.h</a>.</p>

<p>Referenced by <a class="el" href="properties_8c_source.html#l00134">load_properties()</a>, and <a class="el" href="properties_8c_source.html#l00178">store_properties()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a8e43c1c34fed476037718409e086781d"></a><!-- doxytag: member="properties.h::get_property" ref="a8e43c1c34fed476037718409e086781d" args="(map_t *, struct esapi_ctx *, const char *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* get_property </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_map__t.html">map_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the plaintext property value for the given key from the given encrypted properties map. </p>
<p>The property value is Base64 decoded and decrypted for the caller.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>A character array containing a plaintext property value, or NULL if the property was not found. </dd></dl>

<p>Definition at line <a class="el" href="properties_8c_source.html#l00038">38</a> of file <a class="el" href="properties_8c_source.html">properties.c</a>.</p>

<p>References <a class="el" href="crypto_8c_source.html#l00117">esapi_decrypt()</a>, and <a class="el" href="log_8c_source.html#l00090">esapi_log_error()</a>.</p>

<p>Referenced by <a class="el" href="properties_8c_source.html#l00058">get_property_or_default()</a>.</p>

</div>
</div>
<a class="anchor" id="ad03b220df8766ed322c55c7ca4a3cb9b"></a><!-- doxytag: member="properties.h::get_property_or_default" ref="ad03b220df8766ed322c55c7ca4a3cb9b" args="(map_t *, struct esapi_ctx *, const char *, const char *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* get_property_or_default </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_map__t.html">map_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the plaintext property value for the given key from the given encrypted properties map. </p>
<p>If the property is not found, return the given default value.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>A character array containing a plaintext property value. </dd></dl>

<p>Definition at line <a class="el" href="properties_8c_source.html#l00058">58</a> of file <a class="el" href="properties_8c_source.html">properties.c</a>.</p>

<p>References <a class="el" href="properties_8c_source.html#l00038">get_property()</a>.</p>

</div>
</div>
<a class="anchor" id="a102c0a2264a8fe4c84d8b56ffd7a741e"></a><!-- doxytag: member="properties.h::keys" ref="a102c0a2264a8fe4c84d8b56ffd7a741e" args="(map_t *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char** keys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_map__t.html">map_t</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get a list of all keys in the given encrypted properties map. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>An array of character arrays each containing a property key. </dd></dl>

<p>Definition at line <a class="el" href="properties_8c_source.html#l00105">105</a> of file <a class="el" href="properties_8c_source.html">properties.c</a>.</p>

<p>References <a class="el" href="properties_8c_source.html#l00105">keys()</a>.</p>

<p>Referenced by <a class="el" href="properties_8c_source.html#l00105">keys()</a>.</p>

</div>
</div>
<a class="anchor" id="a46f3113de5787541e40a2e7302cfb4d6"></a><!-- doxytag: member="properties.h::load_properties" ref="a46f3113de5787541e40a2e7302cfb4d6" args="(const char *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_map__t.html">map_t</a>* load_properties </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read encrypted properties from the given file. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>A head map_t structure pointer for the loaded properties. </dd></dl>

<p>Definition at line <a class="el" href="properties_8c_source.html#l00134">134</a> of file <a class="el" href="properties_8c_source.html">properties.c</a>.</p>

<p>References <a class="el" href="properties_8h_source.html#l00023">MAX_PROPERTY_LINE_LENGTH</a>.</p>

</div>
</div>
<a class="anchor" id="a5dfcde20fcc2276506a7c99f6a323ba8"></a><!-- doxytag: member="properties.h::set_property" ref="a5dfcde20fcc2276506a7c99f6a323ba8" args="(map_t **, struct esapi_ctx *, const char *, const char *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* set_property </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_map__t.html">map_t</a> **&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structesapi__ctx.html">esapi_ctx</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the given property key-value pair in the given encrypted properties map. </p>
<p>The value is encrypted and Base64 encoded before it is added to the map.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>A character array containing the plaintext property value that was set, or NULL on a failure. </dd></dl>

<p>Definition at line <a class="el" href="properties_8c_source.html#l00069">69</a> of file <a class="el" href="properties_8c_source.html">properties.c</a>.</p>

<p>References <a class="el" href="crypto_8c_source.html#l00033">esapi_encrypt()</a>, and <a class="el" href="log_8c_source.html#l00090">esapi_log_error()</a>.</p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="properties_8h.html">properties.h</a>      </li>
      <li class="footer">Generated on Mon Jan 31 2011 06:10:43 for ESAPI-C by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </li>
    </ul>
  </div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
